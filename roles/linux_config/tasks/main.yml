---
- name: Gather facts if needed
  ansible.builtin.setup:
  when: ansible_os_family is not defined

- name: Check for Linux
  ansible.builtin.fail:
    msg: This role only supports Windows
  when: ansible_os_family != "Linux"

- name: Configure keyboard layout
  ansible.builtin.include_tasks:
    file: keyboard.yml
  when: linux_config['keyboard_layout'] is defined

- name: Configure rdp
  ansible.builtin.include_tasks:
    file: rdp.yml
  when: linux_config['rdp'] is defined

#- name: Install packages
#  ansible.builtin.include_tasks:
#    file: packages.yml
#  when: linux_config['packages'] is defined # This does not work as expected
